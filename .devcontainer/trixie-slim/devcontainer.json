{

	"name": "compose::rust-learning-devcontainer::debian-trixie-slim",

	"dockerComposeFile": "../docker-compose.yml",
	"service": "debian-trixie-slim",
	"shutdownAction": "stopCompose",

    // Properly pass local workspace folder and SSH_AUTH_SOCK to the container
    // for ssh-agent forwarding to work, make sure to have the SSH_AUTH_SOCK
    // environment variable set in your local environment before starting
    // the container, e.g. by adding the following line to your shell profile:
    // eval $(keychain --eval --agents ssh id_ed25519)
	"initializeCommand": "echo \"LOCAL_WORKSPACE_FOLDER=${localWorkspaceFolder}\" > .devcontainer/.env && echo \"SSH_AUTH_SOCK=${localEnv:SSH_AUTH_SOCK:-/tmp/no-agent}\" >> .devcontainer/.env",

	// Note: postCreateCommand will not work when using a vscode workspace file
	"workspaceFolder": "${localWorkspaceFolder}/.vscode/rust-learning.code-workspace",

	"remoteUser": "${localEnv:USER}",

	"features": {
		"ghcr.io/devcontainers/features/github-cli:1": {},
		"ghcr.io/devcontainers/features/common-utils:2": {
			"installZsh": true,
			"configureZshAsDefaultShell": true,
			"installOhMyZsh": true,
			"upgradePackages": true,
			"username": "automatic",
			"uid": "automatic",
			"gid": "automatic"
		},
		"ghcr.io/devcontainers/features/rust:1": {
			"components": [
				"clippy",
				"rust-src",
				"rustfmt"
			]
		}
	},

	"customizations": {
		"vscode": {
			"extensions": [
				"rust-lang.rust-analyzer",
				"vadimcn.vscode-lldb",
				"serayuzgur.crates",
				"ms-python.python",
				"charliermarsh.ruff",
				"ms-vscode.makefile-tools",
				"ms-azuretools.vscode-docker",
				"ms-azuretools.vscode-containers",
				"ms-vscode-remote.remote-containers",
				"yzhang.markdown-all-in-one",
				"tamasfe.even-better-toml",
				"ms-vscode.cpptools-extension-pack",
				"nefrob.vscode-just-syntax"
			]
		}
	}

}
